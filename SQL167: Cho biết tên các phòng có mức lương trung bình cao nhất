SELECT p.MAPHG, p.TENPHG
FROM PHONGBAN p
JOIN NHANVIEN n ON n.PHG = p.MAPHG
GROUP BY p.MAPHG, p.TENPHG
HAVING AVG(n.LUONG) = (
  SELECT MAX(avg_salary)
  FROM (
    SELECT AVG(LUONG) AS avg_salary
    FROM NHANVIEN
    GROUP BY PHG
  ) x
);
